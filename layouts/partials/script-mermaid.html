{{/* Condition check already done in scripts.html */}}
<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
  
  mermaid.initialize({
    startOnLoad: true,
    theme: window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'default',
    securityLevel: 'loose',
    flowchart: {
      useMaxWidth: true,
      htmlLabels: true
    }
  });
  
  // Re-render existing diagrams
  document.addEventListener('DOMContentLoaded', function() {
    mermaid.init(undefined, '.language-mermaid');
  });
</script>

